(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{662:function(s,t,a){"use strict";a.r(t);var n=a(31),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"neovim-入门"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#neovim-入门"}},[s._v("#")]),s._v(" neovim 入门")]),s._v(" "),a("p",[s._v("neovim 部分特性（部分特性在 0.5 后才有）：")]),s._v(" "),a("ul",[a("li",[s._v("使用 lua 作为配置语言，取代了 vimscript\n"),a("ul",[a("li",[s._v("配置换为 lua 后，我的 neovim 载入时间只需要 100ms (i5-8250)")])])]),s._v(" "),a("li",[s._v("使用 treesitter 作为语法高亮，语法高亮更快更好")]),s._v(" "),a("li",[s._v("内置 terminal")]),s._v(" "),a("li",[s._v("floating window")]),s._v(" "),a("li",[s._v("内置 language-server-protocol client")])]),s._v(" "),a("p",[s._v("neovim 插件合集："),a("a",{attrs:{href:"https://github.com/rockerBOO/awesome-neovim",target:"_blank",rel:"noopener noreferrer"}},[s._v("awesome-neovim"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"packer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#packer"}},[s._v("#")]),s._v(" packer")]),s._v(" "),a("p",[s._v("插件管理 "),a("a",{attrs:{href:"https://github.com/wbthomason/packer.nvim",target:"_blank",rel:"noopener noreferrer"}},[s._v("packer"),a("OutboundLink")],1),s._v(" 是第一个安装的，安装后可以轻松安装其他插件")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装 packer")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone --depth "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" https://github.com/wbthomason/packer.nvim"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    ~/.local/share/nvim/site/pack/packer/start/packer.nvim\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("之后添加如下配置，新建 2 个文件：")]),s._v(" "),a("div",{staticClass:"language-lua line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-lua"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- ~/.config/nvim/lua/init.lua")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'plugins'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 加载 plugins.lua")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- ~/.config/nvim/lua/plugins.lua")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("local")]),s._v(" packer "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'packer'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("local")]),s._v(" use "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" packer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("use\npacker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("startup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'lewis6991/gitsigns.nvim'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        opt "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" event "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'BufRead'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        config "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'gitsigns'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setup")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                signs "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    add "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("hl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'GitGutterAdd'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" text "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'+'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                    change "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("hl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'GitGutterChange'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" text "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'~'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                    delete "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" hl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'GitGutterDelete'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" text "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'_'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                    topdelete "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" hl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'GitGutterDelete'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" text "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'‾'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                    changedelete "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" hl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'GitGutterChange'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" text "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'~'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                watch_index "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" interval "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("p",[s._v("添加完后，在 vim 执行命令 "),a("code",[s._v(":PackerCompile")]),s._v(" 会生成 "),a("code",[s._v("~/.config/nvim/plugin/packer_compiled.lua")])]),s._v(" "),a("h2",{attrs:{id:"neovim-lsp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#neovim-lsp"}},[s._v("#")]),s._v(" neovim lsp")]),s._v(" "),a("p",[s._v("neovim 0.5 后还引入内置的 language-server-protocol，简称 lsp，使用步骤：")]),s._v(" "),a("ul",[a("li",[s._v("安装 "),a("a",{attrs:{href:"https://github.com/neovim/nvim-lspconfig",target:"_blank",rel:"noopener noreferrer"}},[s._v("nvim-lspconfig"),a("OutboundLink")],1),s._v(" 插件")]),s._v(" "),a("li",[s._v("安装语言对应的 language-server")])]),s._v(" "),a("div",{staticClass:"language-lua line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-lua"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- basic config")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("local")]),s._v(" on_attach "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" _"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("resolved_capabilities"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("document_highlight "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 高亮当前 Cursor 下的符号")]),s._v("\n        vim"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cmd")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("[[\n            augroup lsp_document_highlight\n                autocmd! * <buffer>\n                au CursorHold <buffer> lua vim.lsp.buf.document_highlight()\n                au CursorHold <buffer> lua require('plugins.current_function').update()\n                au CursorMoved <buffer> lua vim.lsp.buf.clear_references()\n            augroup END\n        ]]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("local")]),s._v(" cap "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" vim"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lsp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("protocol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make_client_capabilities")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 使用默认配置 pyright 的简单例子")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("local")]),s._v(" default_cfg "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" on_attach "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" on_attach"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" capabilities "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cap "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'lspconfig'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pyright"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default_cfg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 配置 clangd 的复杂例子")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'lspconfig'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("clangd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  cmd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'clangd'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--background-index'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--clang-tidy'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--clang-tidy-checks=performance-*,bugprone-*'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--all-scopes-completion'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--completion-style=detailed'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--header-insertion=iwyu'")]),s._v(" \n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  on_attach "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" on_attach"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" capabilities "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cap\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])]),a("p",[s._v("其他 lsp 配置都是类似的配置方式")]),s._v(" "),a("h2",{attrs:{id:"安装-language-server"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装-language-server"}},[s._v("#")]),s._v(" 安装 language-server")]),s._v(" "),a("p",[s._v("language-server 由于使用了不同的语言去实现，安装不同的 language-server 较为复杂")]),s._v(" "),a("p",[s._v("如果 root 或有无需 root 的包管理器，可以直接安装 node 和 yarn")]),s._v(" "),a("p",[s._v("node 类 language-server 的准备：将下载的文件解压后并将 bin 目录添加到 PATH 环境变量")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://npm.taobao.org/mirrors/node/v16.11.1/node-v16.11.1-linux-x64.tar.xz",target:"_blank",rel:"noopener noreferrer"}},[s._v("node"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://yarnpkg.com/latest.tar.gz",target:"_blank",rel:"noopener noreferrer"}},[s._v("yarn"),a("OutboundLink")],1)])]),s._v(" "),a("p",[s._v("node 类的 language-server 通过 "),a("code",[s._v("yarn global add xxx")]),s._v(" 来安装，注意将 "),a("code",[s._v("~/.yarn/bin")]),s._v(" 添加到 PATH")]),s._v(" "),a("ul",[a("li",[s._v("python："),a("a",{attrs:{href:"https://github.com/microsoft/pyright",target:"_blank",rel:"noopener noreferrer"}},[s._v("pyright"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("bash："),a("a",{attrs:{href:"https://github.com/bash-lsp/bash-language-server",target:"_blank",rel:"noopener noreferrer"}},[s._v("bash-language-server"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("javascript："),a("a",{attrs:{href:"https://github.com/microsoft/TypeScript",target:"_blank",rel:"noopener noreferrer"}},[s._v("tsserver"),a("OutboundLink")],1)])]),s._v(" "),a("p",[s._v("其他可能需要单独安装：")]),s._v(" "),a("ul",[a("li",[s._v("c/c++："),a("a",{attrs:{href:"https://github.com/llvm/llvm-project/releases",target:"_blank",rel:"noopener noreferrer"}},[s._v("clangd"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("java："),a("a",{attrs:{href:"https://github.com/eclipse/eclipse.jdt.ls",target:"_blank",rel:"noopener noreferrer"}},[s._v("jdtls"),a("OutboundLink")],1),s._v(" , "),a("a",{attrs:{href:"https://github.com/georgewfraser/java-language-server",target:"_blank",rel:"noopener noreferrer"}},[s._v("java-language-server"),a("OutboundLink")],1)])]),s._v(" "),a("p",[s._v("jdtls 不支持 Android APP 的 gradle 项目，所以只能使用 java-language-server，但是 aosp 可以使用 jdtls")]),s._v(" "),a("h2",{attrs:{id:"java-lsp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#java-lsp"}},[s._v("#")]),s._v(" java lsp")]),s._v(" "),a("p",[s._v("jdtls 需要在 aosp 根目录下新建 build.gradle：")]),s._v(" "),a("div",{staticClass:"language-groovy line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[s._v("apply plugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'java'")]),s._v("\n\nsourceSets "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    main "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        java "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 根据自身的需求增加 srcDirs")]),s._v("\n            srcDirs "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'frameworks/base/services/core/java'")]),s._v("\n            srcDirs "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'frameworks/base/core/java'")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("建议使用 "),a("a",{attrs:{href:"https://github.com/mfussenegger/nvim-jdtls",target:"_blank",rel:"noopener noreferrer"}},[s._v("nvim-jdtls"),a("OutboundLink")],1),s._v(" 来快速配置好 jdtls")]),s._v(" "),a("h2",{attrs:{id:"c-c-lsp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#c-c-lsp"}},[s._v("#")]),s._v(" c/c++ lsp")]),s._v(" "),a("p",[s._v("clangd 需要生成 "),a("code",[s._v("compile_commands.json")]),s._v(" 才可以构建项目的索引，不同构建工具有不同的生成方法")]),s._v(" "),a("ul",[a("li",[s._v("cmake："),a("code",[s._v("cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=ON ..")])]),s._v(" "),a("li",[s._v("普通 make 项目："),a("a",{attrs:{href:"https://github.com/rizsotto/Bear",target:"_blank",rel:"noopener noreferrer"}},[s._v("bear"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("ninja，1.10 以上："),a("code",[s._v("ninja -t compdb > compile_commands.json")])])]),s._v(" "),a("p",[s._v("以 kernel 为例：只需要使用 bear 运行 make，"),a("code",[s._v("bear -- make -j16")])]),s._v(" "),a("h3",{attrs:{id:"aosp-c"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#aosp-c"}},[s._v("#")]),s._v(" aosp c++")]),s._v(" "),a("p",[s._v("aosp 的生成比较复杂，需要分不同 aosp 版本")]),s._v(" "),a("p",[s._v("6.0 以下需要输入一长串命令生成不同子项目的 "),a("code",[s._v("compile_commands.json")]),s._v("：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ONE_SHOT_MAKEFILE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("frameworks/av/media/libmedia/Android.mk "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    ~/.local/bin/compiledb "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" -C /home/workspace2/yexuelin/jmgo_proj/u2_an "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    -f build/core/main.mk all_modules\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("7.0-9.0 的 aosp："),a("a",{attrs:{href:"https://github.com/amezin/aosp-vscode",target:"_blank",rel:"noopener noreferrer"}},[s._v("aosp-vscode"),a("OutboundLink")],1),s._v("，下载仓库的 "),a("code",[s._v("generate_compdb.py")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("python generate_compdb.py out/build-"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${TARGET_PRODUCT}")]),s._v(".ninja\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("10.0 后的 aosp："),a("code",[s._v("export SOONG_GEN_COMPDB=1; make nothing")]),s._v(" 就会在 out 目录下生成")]),s._v(" "),a("h2",{attrs:{id:"neovim-lsp-的使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#neovim-lsp-的使用"}},[s._v("#")]),s._v(" neovim lsp 的使用")]),s._v(" "),a("p",[s._v("可以使用 neovim 自带的 lua 函数去查找定义和引用，也可以使用其他插件去查找定义和引用")]),s._v(" "),a("div",{staticClass:"language-vim line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-vim"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('" 利用 neovim 自带的函数查找定义')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("lua "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("vim")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("lsp")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("buf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("definition")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('" 利用 neovim 自带的函数查找引用')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("lua "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("vim")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("lsp")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("buf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("references")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("推荐几个比较好用的定义和引用查找插件：")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/rmagatti/goto-preview",target:"_blank",rel:"noopener noreferrer"}},[s._v("goto-preview"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/tami5/lspsaga.nvim",target:"_blank",rel:"noopener noreferrer"}},[s._v("lspsaga"),a("OutboundLink")],1)])]),s._v(" "),a("p",[s._v("其他插件的介绍可以看 awesome-neovim")])])}),[],!1,null,null,null);t.default=e.exports}}]);